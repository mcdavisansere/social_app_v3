<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social App - Discover Events & Connect</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #000000;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --border-color: #333333;
            --card-bg: #1a1a1a;
            --modal-bg: #1a1a1a;
            --accent-color: #000000;
            --accent-hover: #333333;
        }

        body.light-mode {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f8f8;
            --bg-tertiary: #f0f0f0;
            --text-primary: #000000;
            --text-secondary: #666666;
            --border-color: #e0e0e0;
            --card-bg: #ffffff;
            --modal-bg: #ffffff;
            --accent-color: #000000;
            --accent-hover: #333333;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s, color 0.3s;
        }

        h1, h2, h3, .event-title, .profile-name {
            font-family: 'Libre Baskerville', serif;
        }

        .container {
            max-width: 414px;
            margin: 0 auto;
            background: var(--bg-primary);
            min-height: 100vh;
            position: relative;
            transition: background-color 0.3s;
        }

        .header {
            background: var(--accent-color);
            color: var(--text-primary);
            padding: 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid var(--border-color);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .theme-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .filters {
            display: flex;
            padding: 15px;
            gap: 10px;
            background: var(--bg-primary);
            overflow-x: auto;
            transition: background-color 0.3s, border-color 0.3s;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            background: transparent;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
            color: var(--text-secondary);
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: var(--accent-color);
            color: var(--text-primary);
            border-color: var(--accent-color);
        }

        body.light-mode .filter-btn:hover,
        body.light-mode .filter-btn.active {
            background: #000000;
            color: #ffffff;
            border-color: #000000;
        }

        .explore-feed {
            padding: 15px;
            padding-bottom: 80px;
        }

        .event-card {
            background: var(--card-bg);
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s, background-color 0.3s, border-color 0.3s;
            margin-bottom: 20px;
            margin-top: 10px;
            display: flex;
            gap: 15px;
            padding: 15px;
            border: 1px solid var(--border-color);
        }

        .event-card:first-of-type {
            margin-top: 15px;
        }

        .event-card:hover {
            transform: translateY(-2px);
            background: var(--bg-tertiary);
        }

        .event-image {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            position: relative;
            border-radius: 12px;
            flex-shrink: 0;
        }

        body.light-mode .event-image {
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
        }

        .save-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .event-info {
            padding: 0;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .event-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .event-meta {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 3px;
        }

        .event-attendees {
            display: flex;
            align-items: center;
            margin-top: 8px;
            gap: 8px;
        }

        .attendee-avatars {
            display: flex;
            gap: -5px;
            cursor: pointer;
            transition: opacity 0.3s;
        }

        .attendee-avatars:hover {
            opacity: 0.8;
        }

        .avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            font-size: 10px;
            border: 2px solid var(--card-bg);
            margin-left: -8px;
        }

        body.light-mode .avatar {
            background: #000000;
            color: #ffffff;
        }

        .avatar:first-child {
            margin-left: 0;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 414px;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: around;
            padding: 15px;
            transition: background-color 0.3s, border-color 0.3s;
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--border-color);
        }

        body.light-mode .bottom-nav {
            background: rgba(255, 255, 255, 0.9);
        }

        .nav-item {
            text-align: center;
            cursor: pointer;
            flex: 1;
            padding: 5px;
            border-radius: 8px;
            transition: color 0.3s;
            color: var(--text-secondary);
        }

        .nav-item:hover,
        .nav-item.active {
            color: var(--text-primary);
        }

        .nav-item.create-btn {
            background: transparent;
            color: var(--text-secondary);
            border-radius: 8px;
            padding: 5px;
        }

        .nav-item.create-btn:hover {
            color: var(--text-primary);
        }

        .nav-item.create-btn.active {
            background: transparent;
            color: var(--text-secondary);
        }

        .nav-item.create-btn .icon {
            color: var(--text-secondary);
            font-size: 24px;
            font-weight: bold;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-item.create-btn .icon svg {
            width: 24px;
            height: 24px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .nav-item.create-btn:hover .icon svg {
            color: var(--text-primary);
        }

        .nav-item .icon {
            font-size: 24px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .nav-item.active .icon {
            color: var(--text-primary);
        }

        .nav-item .icon svg {
            color: inherit;
        }

        .nav-item .label {
            font-size: 12px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
        }

        .modal-content {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            background: var(--modal-bg);
            width: 100%;
            max-width: 414px;
            height: 100vh;
            max-height: 100vh;
            overflow-y: auto;
            border: none;
            transition: background-color 0.3s, border-color 0.3s;
            opacity: 1 !important;
            padding-bottom: 80px;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-primary);
            transition: color 0.3s, border-color 0.3s;
            background: var(--modal-bg);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .modal-body {
            padding: 20px;
            color: var(--text-primary);
            transition: color 0.3s;
            background: var(--modal-bg);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .event-meta {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 3px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .meta-icon {
            flex-shrink: 0;
            color: var(--text-secondary);
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
            transition: color 0.3s;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .user-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .user-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            border-radius: 8px;
            background: var(--bg-tertiary);
            transition: background-color 0.3s;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent-color);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }

        body.light-mode .user-avatar {
            background: #000000;
            color: #ffffff;
        }

        .user-avatar svg {
            width: 24px;
            height: 24px;
            color: white;
        }

        .user-info {
            flex: 1;
            min-width: 0;
        }

        .user-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .user-detail {
            font-size: 12px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .chat-modal-content {
            display: flex;
            flex-direction: column;
            padding-bottom: 0;
        }

        .chat-header {
            flex-shrink: 0;
        }

        .chat-body {
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding: 20px;
            padding-bottom: 0;
        }

        .messages-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .message-bubble {
            display: flex;
            margin-bottom: 8px;
            animation: messageSlide 0.3s ease-in-out;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-bubble.own {
            justify-content: flex-end;
        }

        .message-bubble.other {
            justify-content: flex-start;
        }

        .message-content-bubble {
            max-width: 80%;
            padding: 10px 14px;
            border-radius: 12px;
            word-wrap: break-word;
            font-size: 14px;
        }

        .message-bubble.own .message-content-bubble {
            background: var(--accent-color);
            color: var(--text-primary);
            border-bottom-right-radius: 4px;
        }

        body.light-mode .message-bubble.own .message-content-bubble {
            background: #000000;
            color: #ffffff;
        }

        .message-bubble.other .message-content-bubble {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-bottom-left-radius: 4px;
        }

        .message-sender {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
            padding: 0 14px;
        }

        .chat-input-area {
            display: flex;
            gap: 10px;
            padding: 15px;
            border-top: 1px solid var(--border-color);
            background: var(--bg-primary);
            flex-shrink: 0;
        }

        .message-input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid var(--border-color);
            border-radius: 20px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
            outline: none;
            transition: all 0.3s;
        }

        .message-input::placeholder {
            color: var(--text-secondary);
        }

        .message-input:focus {
            border-color: var(--accent-color);
            background: var(--bg-secondary);
        }

        .send-btn {
            background: var(--accent-color);
            color: var(--text-primary);
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            font-size: 14px;
        }

        body.light-mode .send-btn {
            background: #000000;
            color: #ffffff;
        }

        .send-btn:hover {
            background: var(--accent-hover);
            transform: scale(1.05);
        }

        .send-btn:active {
            transform: scale(0.95);
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background: var(--accent-color);
            color: var(--text-primary);
        }

        body.light-mode .btn-secondary:hover {
            background: #000000;
            color: #ffffff;
        }

        .btn-success {
            background: var(--accent-color);
            color: var(--text-primary);
            width: 100%;
            padding: 12px;
            font-size: 16px;
        }

        body.light-mode .btn-success {
            background: #000000;
            color: #ffffff;
        }

        .btn-success:hover {
            background: var(--accent-hover);
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .action-buttons .btn-secondary {
            flex: 1;
        }

        .action-buttons .btn-success {
            flex: 1;
            width: auto;
        }

        .rating {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
        }

        .star {
            color: #ffc107;
            font-size: 14px;
        }

        .star.empty {
            color: #555;
        }

        .hidden {
            display: none;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state .icon {
            font-size: 64px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .empty-state .icon svg {
            width: 64px;
            height: 64px;
            color: var(--text-secondary);
            stroke: var(--text-secondary);
        }

        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 10px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transition: all 0.3s;
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: var(--text-secondary);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .form-actions button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .form-actions .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .form-actions .btn-secondary:hover {
            background: var(--accent-color);
            color: var(--text-primary);
        }

        body.light-mode .form-actions .btn-secondary:hover {
            background: #000000;
            color: #ffffff;
        }

        .form-actions .btn-success {
            background: var(--accent-color);
            color: var(--text-primary);
        }

        body.light-mode .form-actions .btn-success {
            background: #000000;
            color: #ffffff;
        }

        .form-actions .btn-success:hover {
            background: var(--accent-hover);
        }

        .plus-btn {
            display: none;
        }

        .plus-btn:hover {
            background: #8b6f47;
            transform: scale(1.1);
        }

        .profile-header {
            background: var(--accent-color);
            color: var(--text-primary);
            padding: 30px 20px;
            text-align: center;
            border-radius: 0 0 16px 16px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        body.light-mode .profile-header {
            background: #000000;
            color: #ffffff;
        }

        .profile-avatar-large {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 700;
            margin: 0 auto 15px;
            border: 3px solid white;
        }

        .profile-name {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .profile-username {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .profile-bio {
            font-size: 13px;
            opacity: 0.85;
            margin-bottom: 20px;
        }

        .profile-stats {
            display: flex;
            justify-content: space-around;
            gap: 20px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.9;
            margin-top: 5px;
        }

        .profile-section {
            padding: 0 15px 20px;
        }

        .settings-list {
            background: var(--card-bg);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
            transition: all 0.3s;
        }

        .settings-item {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background 0.2s;
            color: var(--text-primary);
        }

        .settings-item:hover {
            background: var(--bg-tertiary);
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-item.logout {
            color: #ff6b6b;
        }

        .profile-events-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .profile-event-item {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 15px;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
        }

        .profile-event-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            flex-shrink: 0;
        }

        body.light-mode .profile-event-icon {
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
        }

        .profile-event-info {
            flex: 1;
        }

        .profile-event-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 5px;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .profile-event-detail {
            font-size: 12px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .messages-list {
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .message-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .message-item:hover {
            background: var(--bg-tertiary);
        }

        .message-avatar {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
            color: var(--text-primary);
        }

        body.light-mode .message-avatar {
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
        }

        .message-content {
            flex: 1;
            min-width: 0;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 4px;
        }

        .message-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .message-time {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .message-preview {
            font-size: 13px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .message-members {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 3px;
            font-weight: 500;
        }

        .message-unread {
            width: 10px;
            height: 10px;
            background: var(--accent-color);
            border-radius: 50%;
            flex-shrink: 0;
        }

        body.light-mode .message-unread {
            background: #000000;
        }

        .toggle-section {
            padding: 15px;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .toggle-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .toggle-switch {
            width: 50px;
            height: 28px;
            background: var(--accent-color);
            border-radius: 14px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
            border: none;
            padding: 0;
        }

        body.light-mode .toggle-switch {
            background: #000000;
        }

        .toggle-switch.active {
            background: var(--accent-color);
        }

        body.light-mode .toggle-switch.active {
            background: #000000;
        }

        .toggle-switch:not(.active) {
            background: var(--bg-tertiary);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: left 0.3s;
        }

        .toggle-switch.active::after {
            left: 24px;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            font-size: 14px;
            color: var(--text-primary);
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--accent-color);
        }

        body.light-mode .checkbox-item input[type="checkbox"] {
            accent-color: #000000;
        }

        .selected-categories {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .category-tag {
            background: var(--accent-color);
            color: var(--text-primary);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        body.light-mode .category-tag {
            background: #000000;
            color: #ffffff;
        }

        .category-tag:hover {
            background: var(--accent-hover);
        }

        .category-tag .remove-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 16px;
            padding: 0;
            margin-left: 4px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <h1 style="margin: 0;">Social App</h1>
                <!-- <button id="themeToggle" class="theme-toggle" onclick="toggleTheme()">üåô</button> -->
            </div>
        </div>

        <div id="exploreFeed" class="explore-feed">
            <div class="filters">
                <button class="filter-btn active" id="filterAllBtn" onclick="filterEvents('all')">All</button>
                <button class="filter-btn" id="filterSocialBtn" onclick="toggleCategoryFilter('social')">üéâ Social</button>
                <button class="filter-btn" id="filterFitnessBtn" onclick="toggleCategoryFilter('fitness')">üí™ Fitness</button>
                <button class="filter-btn" id="filterCreativeBtn" onclick="toggleCategoryFilter('creative')">üé® Creative</button>
                <button class="filter-btn" id="filterProfessionalBtn" onclick="toggleCategoryFilter('professional')">üíº Professional</button>
                <button class="filter-btn" onclick="openModal('advancedFiltersModal')">‚öôÔ∏è Filters</button>
            </div>
            <div id="eventsList"></div>
        </div>

        <div id="savedEvents" class="explore-feed hidden"></div>

        <div id="messagesPage" class="explore-feed hidden">
            <div id="messagesList"></div>
        </div>

        <div id="profilePage" class="explore-feed hidden">
            <div class="profile-header">
                <div class="profile-avatar-large">JD</div>
                <h2 class="profile-name">John Doe</h2>
                <p class="profile-username">@johndoe</p>
                <p class="profile-bio">Adventure seeker | Coffee lover | Events enthusiast</p>
                <div class="profile-stats">
                    <div class="stat">
                        <div class="stat-value">24</div>
                        <div class="stat-label">Events Attended</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">8</div>
                        <div class="stat-label">Events Hosted</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">4.7</div>
                        <div class="stat-label">Rating</div>
                    </div>
                </div>
            </div>
            <div class="profile-section">
                <div class="toggle-section">
                    <span class="toggle-label">Open to Connections</span>
                    <button class="toggle-switch active" id="connectionsToggle" onclick="toggleConnections()"></button>
                </div>
            </div>

            <div class="profile-section">
                <h3 class="section-title">Your Upcoming Events</h3>
                <div class="profile-events-grid" id="upcomingEventsList"></div>
            </div>

            <div class="profile-section">
                <h3 class="section-title">Your Hosted Events</h3>
                <div class="profile-events-grid" id="hostedEventsList"></div>
            </div>


            <div class="profile-section">
                <h3 class="section-title">Account Settings</h3>
                <div class="settings-list">
                    <div class="settings-item">
                        <span>Edit Profile</span>
                        <span>‚Üí</span>
                    </div>
                    <div class="settings-item">
                        <span>Notifications</span>
                        <span>‚Üí</span>
                    </div>
                    <div class="settings-item">
                        <span>Privacy Settings</span>
                        <span>‚Üí</span>
                    </div>
                    <div class="settings-item">
                        <span>Help & Support</span>
                        <span>‚Üí</span>
                    </div>
                    <div class="settings-item logout">
                        <span>Log Out</span>
                        <span>‚Üí</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="bottom-nav">
            <div class="nav-item active" onclick="switchPage('explore', this)">
                <div class="icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </div>
                <!-- <div class="label">Explore</div> -->
            </div>
            <div class="nav-item" onclick="switchPage('saved', this)">
                <div class="icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                </div>
                <!-- <div class="label">Saved</div> -->
            </div>
            <div class="nav-item" onclick="switchPage('messages', this)">
                <div class="icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                </div>
                <!-- <div class="label">Messages</div> -->
            </div>
            <div class="nav-item create-btn" onclick="openModal('createEventModal'); event.stopPropagation();">
                <div class="icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
                        <rect x="3" y="3" width="18" height="18" rx="4" ry="4"></rect>
                        <line x1="12" y1="8" x2="12" y2="16"></line>
                        <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                </div>
                <!-- <div class="label">Create</div> -->
            </div>
            <div class="nav-item" onclick="switchPage('profile', this)">
                <div class="icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                <!-- <div class="label">Profile</div> -->
            </div>
        </div>
    </div>

    <div id="attendeesModal" class="modal"
        onclick="if(event.target.id === 'attendeesModal') closeModal('attendeesModal')">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="attendeesModalTitle">People Attending</h2>
                <button class="close-btn" onclick="closeModal('attendeesModal')">&times;</button>
            </div>
            <div class="modal-body" id="attendeesModalBody"></div>
        </div>
    </div>

    <div id="eventModal" class="modal" onclick="if(event.target.id === 'eventModal') closeModal('eventModal')">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Event Details</h2>
                <button class="close-btn" onclick="closeModal('eventModal')">&times;</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <div id="createEventModal" class="modal"
        onclick="if(event.target.id === 'createEventModal') closeModal('createEventModal')">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create Event</h2>
                <button class="close-btn" onclick="closeModal('createEventModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createEventForm">
                    <div class="form-group">
                        <label>Event Title</label>
                        <input type="text" name="title" required>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select name="category" required>
                            <option value="social">Social</option>
                            <option value="fitness">Fitness</option>
                            <option value="creative">Creative</option>
                            <option value="professional">Professional</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" name="date" required>
                    </div>
                    <div class="form-group">
                        <label>Time</label>
                        <input type="time" name="time" required>
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" name="location" required>
                    </div>
                    <div class="form-group">
                        <label>Cost ($)</label>
                        <input type="number" name="cost" min="0" step="0.01" value="0">
                    </div>
                    <div class="form-group">
                        <label>Max Attendees</label>
                        <input type="number" name="maxAttendees" min="1">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea name="description"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="saveDraft()">Save Draft</button>
                        <button type="button" class="btn-success" onclick="createEvent()">Create Event</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="advancedFiltersModal" class="modal" onclick="if(event.target.id === 'advancedFiltersModal') closeModal('advancedFiltersModal')">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Advanced Filters</h2>
                <button class="close-btn" onclick="closeModal('advancedFiltersModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="advancedFiltersForm">
                    <div class="form-group">
                        <label>Category</label>
                        <div style="display: flex; gap: 8px;">
                            <select id="filterCategory" name="category" style="flex: 1;">
                                <option value="">Select Category</option>
                                <option value="social">üéâ Social</option>
                                <option value="fitness">üí™ Fitness</option>
                                <option value="creative">üé® Creative</option>
                                <option value="professional">üíº Professional</option>
                            </select>
                            <button type="button" class="btn btn-secondary" onclick="addCategoryFilter()" style="flex: 0; width: auto; padding: 10px 16px;">Add</button>
                        </div>
                        <div class="selected-categories" id="selectedCategoriesContainer"></div>
                    </div>
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" id="filterDate" name="date">
                    </div>
                    <div class="form-group">
                        <label>Time</label>
                        <input type="time" id="filterTime" name="time">
                    </div>
                    <div class="form-group">
                        <label>Max Cost ($)</label>
                        <input type="number" id="filterCost" name="cost" min="0" step="0.01" placeholder="Enter max cost">
                    </div>
                    <div class="form-group">
                        <label>Host Name</label>
                        <input type="text" id="filterHost" name="host" placeholder="Search by host name">
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="filterLocation" name="location" placeholder="Search by location">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="resetFilters()">Reset</button>
                        <button type="button" class="btn-success" onclick="applyAdvancedFilters()">Apply Filters</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="chatModal" class="modal" onclick="if(event.target.id === 'chatModal') closeModal('chatModal')">
        <div class="modal-content chat-modal-content">
            <div class="modal-header chat-header">
                <h2 id="chatTitle">Chat</h2>
                <button class="close-btn" onclick="closeModal('chatModal')">&times;</button>
            </div>
            <div class="modal-body chat-body">
                <div id="messagesContainer" class="messages-container"></div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="messageInput" class="message-input" placeholder="Type a message..." onkeypress="handleMessageKeyPress(event)">
                <button class="send-btn" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>

    <script>
        let currentPage = 'explore';
        let currentFilter = 'all';
        let savedEventIds = [];
        let groupChats = {}; // Store group chats by event id

        const sampleEvents = [
            {
                id: 1,
                title: 'Weekend Hike Adventure',
                category: 'fitness',
                date: '2024-02-10',
                time: '08:00 AM',
                location: 'Mountain Trail, CO',
                host: 'Sarah Chen',
                cost: 0,
                maxAttendees: 20,
                currentAttendees: 12,
                description: 'Join us for an exciting weekend hike through beautiful mountain trails. Suitable for beginners to intermediate hikers.',
                attendees: [
                    { name: 'Alex Johnson', initial: 'AJ', mutual: true },
                    { name: 'Maria Garcia', initial: 'MG', mutual: false },
                    { name: 'James Wilson', initial: 'JW', mutual: true }
                ],
                rating: 4.8,
                saved: false
            },
            {
                id: 2,
                title: 'Art Painting Workshop',
                category: 'creative',
                date: '2024-02-12',
                time: '02:00 PM',
                location: 'Downtown Art Studio, CA',
                host: 'Maya Patel',
                cost: 25,
                maxAttendees: 15,
                currentAttendees: 8,
                description: 'Learn basic painting techniques from professional artists. All materials provided. Perfect for beginners!',
                attendees: [
                    { name: 'Emma Stone', initial: 'ES', mutual: true },
                    { name: 'Oliver Brown', initial: 'OB', mutual: false },
                    { name: 'Sophie Turner', initial: 'ST', mutual: false }
                ],
                rating: 4.5,
                saved: false
            },
            {
                id: 3,
                title: 'Tech Networking Mixer',
                category: 'professional',
                date: '2024-02-15',
                time: '06:00 PM',
                location: 'Tech Hub Downtown, NY',
                host: 'David Kumar',
                cost: 15,
                maxAttendees: 50,
                currentAttendees: 35,
                description: 'Meet fellow tech enthusiasts, entrepreneurs, and investors. Great opportunity to expand your network.',
                attendees: [
                    { name: 'Lisa Chen', initial: 'LC', mutual: true },
                    { name: 'Mark Thompson', initial: 'MT', mutual: true },
                    { name: 'Rachel Green', initial: 'RG', mutual: false },
                    { name: 'Paul Anderson', initial: 'PA', mutual: false }
                ],
                rating: 4.2,
                saved: false
            },
            {
                id: 4,
                title: 'Jazz Night Party',
                category: 'social',
                date: '2024-02-18',
                time: '08:00 PM',
                location: 'Blue Moon Bar, LA',
                host: 'Jessica White',
                cost: 20,
                maxAttendees: 100,
                currentAttendees: 67,
                description: 'Evening of live jazz music with drinks and appetizers. Dress code: Smart casual.',
                attendees: [
                    { name: 'Chris Evans', initial: 'CE', mutual: false },
                    { name: 'Diana Ross', initial: 'DR', mutual: true },
                    { name: 'Edward Norton', initial: 'EN', mutual: false }
                ],
                rating: 4.7,
                saved: false
            },
            {
                id: 5,
                title: 'Yoga & Meditation Class',
                category: 'fitness',
                date: '2024-02-20',
                time: '07:00 AM',
                location: 'Zen Wellness Center, TX',
                host: 'Priya Sharma',
                cost: 12,
                maxAttendees: 30,
                currentAttendees: 22,
                description: 'Start your day with a refreshing yoga session followed by guided meditation.',
                attendees: [
                    { name: 'Hannah Montana', initial: 'HM', mutual: true },
                    { name: 'Ian McKellen', initial: 'IM', mutual: false }
                ],
                rating: 4.9,
                saved: false
            }
        ];

        function switchPage(page, navItem) {
            currentPage = page;
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            navItem.classList.add('active');

            if (page === 'explore') {
                showPage('explore');
            } else if (page === 'saved') {
                showPage('saved');
            } else if (page === 'messages') {
                showPage('messages');
                renderMessagesPage();
            } else if (page === 'profile') {
                showPage('profile');
                renderProfilePage();
            }
        }

        function filterEvents(category) {
            currentFilter = category;
            topLevelSelectedCategories = [];
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderEvents();
        }

        function toggleTheme() {
            const html = document.documentElement;
            const isDarkMode = html.classList.contains('light-mode');

            if (isDarkMode) {
                html.classList.remove('light-mode');
                localStorage.setItem('theme', 'dark');
                document.getElementById('themeToggle').textContent = 'üåô';
            } else {
                html.classList.add('light-mode');
                localStorage.setItem('theme', 'light');
                document.getElementById('themeToggle').textContent = '‚òÄÔ∏è';
            }
        }

        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            if (savedTheme === 'light') {
                document.documentElement.classList.add('light-mode');
                document.getElementById('themeToggle').textContent = '‚òÄÔ∏è';
            }
        }

        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function renderEvents() {
            const eventsList = document.getElementById('eventsList');
            let filteredEvents = sampleEvents;

            if (currentFilter !== 'all') {
                filteredEvents = sampleEvents.filter(e => e.category === currentFilter);
            }

            eventsList.innerHTML = filteredEvents.map(event => `
                <div class="event-card" onclick="showEventDetails(${event.id})">
                    <div class="event-image">
                        ${getCategoryIcon(event.category)}
                        ${getSaveButtonHTML(event.id, event.saved)}
                    </div>
                    <div class="event-info">
                        <div class="event-title">${event.title}</div>
                        <div class="event-meta">
                            <svg class="meta-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                            ${formatDate(event.date)} at ${event.time}
                        </div>
                        <div class="event-meta">
                            <svg class="meta-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                <circle cx="12" cy="10" r="3"></circle>
                            </svg>
                            ${event.location}
                        </div>
                        <div class="event-meta">
                            <svg class="meta-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            ${event.host}
                        </div>
                        <div class="event-attendees">
                            <div class="attendee-avatars" onclick="showAttendeesList(event, ${event.id}); event.stopPropagation();">
                                ${event.attendees.slice(0, 3).map(attendee => `
                                    <div class="avatar">${attendee.initial}</div>
                                `).join('')}
                                ${event.attendees.length > 3 ? `<div class="avatar">+${event.attendees.length - 3}</div>` : ''}
                            </div>
                            <span class="event-meta" style="margin-left: 8px;">
                                <svg class="meta-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="9" cy="7" r="4"></circle>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                </svg>
                                ${event.currentAttendees} going
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getCategoryIcon(category) {
            const icons = {
                social: 'üéâ',
                fitness: 'üí™',
                creative: 'üé®',
                professional: 'üíº'
            };
            return icons[category] || 'üìÖ';
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
        }

        function renderStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 !== 0;
            let stars = '';

            for (let i = 0; i < fullStars; i++) {
                stars += '<span class="star">‚òÖ</span>';
            }
            if (hasHalfStar) {
                stars += '<span class="star">‚òÖ</span>';
            }
            for (let i = fullStars + (hasHalfStar ? 1 : 0); i < 5; i++) {
                stars += '<span class="star empty">‚òÖ</span>';
            }
            return stars;
        }

        function getUserAvatarIcon(initial) {
            return `
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            `;
        }

        function getSaveButtonHTML(eventId, isSaved) {
            return `
                <button class="save-btn" onclick="toggleSave(event, ${eventId})">
                    ${isSaved ? `
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="#b8860b" stroke="#b8860b" stroke-width="2">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                    ` : `
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                    `}
                </button>
            `;
        }

        function toggleSave(event, eventId) {
            event.stopPropagation();
            const eventObj = sampleEvents.find(e => e.id === eventId);
            eventObj.saved = !eventObj.saved;

            if (eventObj.saved) {
                savedEventIds.push(eventId);
            } else {
                savedEventIds = savedEventIds.filter(id => id !== eventId);
            }

            renderEvents();
            if (currentPage === 'saved') {
                renderSavedEvents();
            }
        }

        function showEventDetails(eventId) {
            const event = sampleEvents.find(e => e.id === eventId);
            const modal = document.getElementById('eventModal');
            const modalBody = document.getElementById('modalBody');

            document.getElementById('modalTitle').textContent = event.title;

            modalBody.innerHTML = `
                <div class="section">
                    <div class="event-meta">
                        <svg class="meta-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        ${formatDate(event.date)} at ${event.time}
                    </div>
                    <div class="event-meta">
                        <svg class="meta-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                        ${event.location}
                    </div>
                    <div class="event-meta">
                        <svg class="meta-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                        Hosted by ${event.host}
                    </div>
                    <div class="event-meta">
                        <svg class="meta-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 1v6m0 6v6"></path>
                            <path d="M4.22 4.22l4.24 4.24m4.24 4.24l4.24 4.24"></path>
                            <path d="M1 12h6m6 0h6"></path>
                            <path d="M19.78 4.22l-4.24 4.24m-4.24 4.24l-4.24 4.24"></path>
                        </svg>
                        ${event.cost === 0 ? 'Free' : '$' + event.cost}
                    </div>
                    <div class="event-meta">
                        <svg class="meta-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        ${event.currentAttendees}/${event.maxAttendees || '‚àû'} attending
                    </div>
                </div>
                
                <div class="section">
                    <p>${event.description}</p>
                </div>
                
                <div class="section">
                    <div class="section-title">Mutuals You Can Invite</div>
                    <div class="user-list">
                        ${event.attendees.filter(a => a.mutual).map(attendee => `
                            <div class="user-item">
                                <div class="user-avatar">${getUserAvatarIcon()}</div>
                                <div class="user-info">
                                    <div class="user-name">${attendee.name}</div>
                                    <div class="user-detail">Mutual connection</div>
                                </div>
                                <button class="btn btn-secondary">Invite</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">People Attending</div>
                    <div class="attendee-avatars" onclick="toggleAttendeesList(this, ${event.id})">
                        ${event.attendees.slice(0, 3).map(attendee => `
                            <div class="avatar">${attendee.initial}</div>
                        `).join('')}
                        ${event.attendees.length > 3 ? `<div class="avatar">+${event.attendees.length - 3}</div>` : ''}
                        <span class="event-meta" style="margin-left: 8px;">${event.currentAttendees} going</span>
                    </div>
                    <div class="attendees-list-container" id="attendees-list-${event.id}" style="display: none; margin-top: 15px;">
                        <div class="user-list">
                            ${event.attendees.map(attendee => `
                                <div class="user-item">
                                    <div class="user-avatar">${getUserAvatarIcon()}</div>
                                    <div class="user-info">
                                        <div class="user-name">${attendee.name}</div>
                                        <div class="user-detail">${attendee.mutual ? 'Mutual connection' : 'Open to new people'}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
                                ${document.getElementById('connectionsToggle') && document.getElementById('connectionsToggle').classList.contains('active') ? `
                                <div class="section">
                    <div class="section-title">Open</div>
                    <div class="attendee-avatars" onclick="toggleAttendeesList(this, ${event.id}, 'Open')">
                        ${event.attendees.slice(0, 3).map(attendee => `
                            <div class="avatar">${attendee.initial}</div>
                        `).join('')}
                        ${event.attendees.length > 3 ? `<div class="avatar">+${event.attendees.length - 3}</div>` : ''}
                        <span class="event-meta" style="margin-left: 8px;">${event.currentAttendees} going</span>
                    </div>
                    <div class="attendees-list-container" id="attendees-list-one-${event.id}" style="display: none; margin-top: 15px;">
                        <div class="user-list">
                            ${event.attendees.map(attendee => `
                                <div class="user-item">
                                    <div class="user-avatar">${getUserAvatarIcon()}</div>
                                    <div class="user-info">
                                        <div class="user-name">${attendee.name}</div>
                                        <div class="user-detail">${attendee.mutual ? 'Mutual connection' : 'Open to new people'}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
                ` : ''}
                
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="shareEvent(${event.id})">Share</button>
                    <button class="btn btn-success" onclick="bookEvent(${event.id})">
                        ${event.cost === 0 ? 'Join Event' : 'Book'}
                    </button>
                </div>
            `;

            modal.style.display = 'block';
        }

        function showPage(page) {
            document.getElementById('exploreFeed').classList.toggle('hidden', page !== 'explore');
            document.getElementById('savedEvents').classList.toggle('hidden', page !== 'saved');
            document.getElementById('messagesPage').classList.toggle('hidden', page !== 'messages');
            document.getElementById('profilePage').classList.toggle('hidden', page !== 'profile');

            if (page === 'saved') {
                renderSavedEvents();
            } else if (page === 'profile') {
                renderProfilePage();
            }
        }

        function renderSavedEvents() {
            const savedContainer = document.getElementById('savedEvents');
            const savedEvents = sampleEvents.filter(event => savedEventIds.includes(event.id));

            if (savedEvents.length === 0) {
                savedContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                        </div>
                        <h3>No Saved Events</h3>
                        <p>Events you save will appear here</p>
                    </div>
                `;
            } else {
                savedContainer.innerHTML = savedEvents.map(event => `
                    <div class="event-card" onclick="showEventDetails(${event.id})">
                        <div class="event-image">
                            ${getCategoryIcon(event.category)}
                        </div>
                        <div class="event-info">
                            <div class="event-title">${event.title}</div>
                            <div class="event-meta">üìÖ ${formatDate(event.date)} at ${event.time}</div>
                            <div class="event-meta">üìç ${event.location}</div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function createEvent() {
            const form = document.getElementById('createEventForm');
            const formData = new FormData(form);

            const newEvent = {
                id: sampleEvents.length + 1,
                title: formData.get('title'),
                category: formData.get('category'),
                date: formData.get('date'),
                time: formData.get('time'),
                location: formData.get('location'),
                host: 'You',
                cost: parseFloat(formData.get('cost')) || 0,
                maxAttendees: parseInt(formData.get('maxAttendees')) || null,
                currentAttendees: 1,
                description: formData.get('description') || '',
                attendees: [{ name: 'You', initial: 'Y', mutual: false }],
                rating: 0,
                saved: false
            };

            sampleEvents.unshift(newEvent);
            closeModal('createEventModal');
            form.reset();
            renderEvents();

            alert('Event created successfully!');
        }

        function saveDraft() {
            alert('Event saved as draft!');
            closeModal('createEventModal');
        }

        function bookEvent(eventId) {
            const event = sampleEvents.find(e => e.id === eventId);
            if (event.cost > 0) {
                alert(`Payment processed! You've booked ${event.title} for $${event.cost}`);
            } else {
                alert(`You've joined ${event.title}!`);
            }
            event.currentAttendees++;
            
            // Create/update group chat for this event
            createEventGroupChat(event);
            
            closeModal('eventModal');
            renderEvents();
        }

        function createEventGroupChat(event) {
            // Check if group chat already exists for this event
            if (!groupChats[event.id]) {
                // Create new group chat with all attendees
                const groupChatName = `${event.title}`;
                const members = event.attendees.map(attendee => ({
                    name: attendee.name,
                    avatar: getRandomEmoji()
                }));
                
                // Add the user (John Doe) as well
                members.push({
                    name: 'You',
                    avatar: 'üë§'
                });

                groupChats[event.id] = {
                    id: `chat_${event.id}`,
                    name: groupChatName,
                    eventId: event.id,
                    members: members,
                    lastMessage: `Welcome to ${event.title}! Discussion about the event.`,
                    time: 'now',
                    avatar: getCategoryEmoji(event.category),
                    unread: true,
                    isGroupChat: true,
                    timestamp: Date.now() // Track when chat was created/modified
                };
            } else {
                // Add user to existing group chat
                const chat = groupChats[event.id];
                if (!chat.members.some(m => m.name === 'You')) {
                    chat.members.push({
                        name: 'You',
                        avatar: 'üë§'
                    });
                }
                chat.unread = true;
                chat.timestamp = Date.now(); // Update timestamp when modified
            }
            
            // Re-render messages page if it's currently open
            if (currentPage === 'messages') {
                renderMessagesPage();
            }
        }

        function getRandomEmoji() {
            const emojis = ['üë®', 'üë©', 'üë®‚Äçüíº', 'üë©‚Äçüíº', 'üë®‚Äçüî¨', 'üë©‚Äçüî¨', 'üë®‚Äçüé®', 'üë©‚Äçüé®', 'üë±‚Äç‚ôÇÔ∏è', 'üë±‚Äç‚ôÄÔ∏è'];
            return emojis[Math.floor(Math.random() * emojis.length)];
        }

        function getCategoryEmoji(category) {
            const emojis = {
                'social': 'üéâ',
                'fitness': 'üí™',
                'creative': 'üé®',
                'professional': 'üíº'
            };
            return emojis[category] || 'üìå';
        }

        function shareEvent(eventId) {
            const event = sampleEvents.find(e => e.id === eventId);
            if (navigator.share) {
                navigator.share({
                    title: event.title,
                    text: event.description,
                    url: window.location.href
                });
            } else {
                const shareText = `Check out this event: ${event.title} on ${formatDate(event.date)} at ${event.location}`;
                navigator.clipboard.writeText(shareText);
                alert('Event link copied to clipboard!');
            }
        }

        function toggleAttendeesList(element, eventId, listTag) {
            const listContainer = (listTag != 'Open') ? document.getElementById(`attendees-list-${eventId}`) : document.getElementById(`attendees-list-one-${eventId}`);
            if (listContainer.style.display === 'none') {
                listContainer.style.display = 'block';
            } else {
                listContainer.style.display = 'none';
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function showAttendeesList(clickEvent, eventId) {
            const event = sampleEvents.find(e => e.id === eventId);
            const modal = document.getElementById('attendeesModal');
            const modalBody = document.getElementById('attendeesModalBody');

            document.getElementById('attendeesModalTitle').textContent = `People Attending (${event.currentAttendees})`;

            modalBody.innerHTML = `
                <div class="user-list">
                    ${event.attendees.map(attendee => `
                        <div class="user-item">
                            <div class="user-avatar">${getUserAvatarIcon()}</div>
                            <div class="user-info">
                                <div class="user-name">${attendee.name}</div>
                                <div class="user-detail">${attendee.mutual ? 'Mutual connection' : 'Open to new people'}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;

            modal.style.display = 'block';
        }

        function renderProfilePage() {
            const upcomingEventsList = document.getElementById('upcomingEventsList');
            const upcomingEvents = sampleEvents.slice(0, 2);

            upcomingEventsList.innerHTML = upcomingEvents.map(event => `
                <div class="profile-event-item">
                    <div class="profile-event-icon">${getCategoryIcon(event.category)}</div>
                    <div class="profile-event-info">
                        <div class="profile-event-title">${event.title}</div>
                        <div class="profile-event-detail">üìÖ ${formatDate(event.date)}</div>
                        <div class="profile-event-detail">üìç ${event.location}</div>
                    </div>
                </div>
            `).join('');

            const hostedEventsList = document.getElementById('hostedEventsList');
            const hostedEvents = sampleEvents.slice(2, 4);

            hostedEventsList.innerHTML = hostedEvents.map(event => `
                <div class="profile-event-item">
                    <div class="profile-event-icon">${getCategoryIcon(event.category)}</div>
                    <div class="profile-event-info">
                        <div class="profile-event-title">${event.title}</div>
                        <div class="profile-event-detail">üìÖ ${formatDate(event.date)}</div>
                        <div class="profile-event-detail">üë• ${event.currentAttendees} attending</div>
                    </div>
                </div>
            `).join('');
        }

        function renderMessagesPage() {
            const messagesList = document.getElementById('messagesList');
            const sampleMessages = [
                {
                    id: 1,
                    name: 'Sarah Johnson',
                    avatar: 'üë©',
                    lastMessage: 'Hey! Are you going to the event next week?',
                    time: '2m',
                    unread: true,
                    isGroupChat: false,
                    timestamp: Date.now() - (2 * 60 * 1000) // 2 minutes ago
                },
                {
                    id: 2,
                    name: 'Mike Chen',
                    avatar: 'üë®',
                    lastMessage: 'Great workout session today!',
                    time: '1h',
                    unread: false,
                    isGroupChat: false,
                    timestamp: Date.now() - (60 * 60 * 1000) // 1 hour ago
                },
                {
                    id: 3,
                    name: 'Emma Williams',
                    avatar: 'üë±‚Äç‚ôÄÔ∏è',
                    lastMessage: 'Love your artwork from the gallery!',
                    time: '3h',
                    unread: true,
                    isGroupChat: false,
                    timestamp: Date.now() - (3 * 60 * 60 * 1000) // 3 hours ago
                },
                {
                    id: 4,
                    name: 'James Rodriguez',
                    avatar: 'üë®‚Äçüíº',
                    lastMessage: 'Let\'s schedule a coffee meeting next week',
                    time: '5h',
                    unread: false,
                    isGroupChat: false,
                    timestamp: Date.now() - (5 * 60 * 60 * 1000) // 5 hours ago
                },
                {
                    id: 5,
                    name: 'Lisa Park',
                    avatar: 'üë©‚Äçüî¨',
                    lastMessage: 'Thanks for the amazing event last weekend!',
                    time: 'Yesterday',
                    unread: true,
                    isGroupChat: false,
                    timestamp: Date.now() - (24 * 60 * 60 * 1000) // 1 day ago
                }
            ];

            // Combine sample messages with group chats from events
            const allMessages = [...sampleMessages, ...Object.values(groupChats)];
            
            // Sort messages by timestamp (most recently joined/modified first)
            allMessages.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));

            messagesList.innerHTML = `
                <div class="messages-list">
                    ${allMessages.map(msg => `
                        <div class="message-item" onclick="openMessage('${msg.id}', '${msg.name}', ${msg.isGroupChat ? true : false})">
                            <div class="message-avatar">${msg.avatar}</div>
                            <div class="message-content">
                                <div class="message-header">
                                    <div class="message-name">${msg.name}${msg.isGroupChat ? ' üë•' : ''}</div>
                                    <div class="message-time">${msg.time}</div>
                                </div>
                                <div class="message-preview">${msg.lastMessage}</div>
                                ${msg.isGroupChat ? `<div class="message-members">${msg.members.length} members</div>` : ''}
                            </div>
                            ${msg.unread ? '<div class="message-unread"></div>' : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        let currentChatId = null;
        let chatMessages = {}; // Store messages by chat ID

        function openMessage(messageId, name, isGroupChat) {
            currentChatId = messageId;
            
            let chatName = name;
            let groupChatObj = null;
            
            // Check if this is a group chat from an event
            if (isGroupChat) {
                groupChatObj = Object.values(groupChats).find(chat => chat.id === messageId);
                if (groupChatObj) {
                    chatName = groupChatObj.name;
                }
            }
            
            // Initialize chat messages if not exists
            if (!chatMessages[messageId]) {
                chatMessages[messageId] = [];
                
                // Add welcome message for group chats
                if (groupChatObj) {
                    chatMessages[messageId].push({
                        id: 'welcome_' + messageId,
                        text: `Welcome to ${groupChatObj.name}! You can now chat with all ${groupChatObj.members.length} members.`,
                        sender: 'system',
                        timestamp: Date.now()
                    });
                }
            }
            
            document.getElementById('chatTitle').textContent = chatName;
            openModal('chatModal');
            renderChatMessages();
            
            // Focus on input
            setTimeout(() => {
                document.getElementById('messageInput').focus();
            }, 100);
        }

        function renderChatMessages() {
            const container = document.getElementById('messagesContainer');
            const messages = chatMessages[currentChatId] || [];
            
            container.innerHTML = messages.map(msg => {
                if (msg.sender === 'system') {
                    return `<div class="system-message" style="text-align: center; padding: 10px; color: var(--text-secondary); font-size: 12px;">${msg.text}</div>`;
                }
                
                const isOwn = msg.sender === 'You';
                return `
                    <div class="message-bubble ${isOwn ? 'own' : 'other'}">
                        ${!isOwn ? `<div class="message-sender">${msg.sender}</div>` : ''}
                        <div class="message-content-bubble">${escapeHtml(msg.text)}</div>
                    </div>
                `;
            }).join('');
            
            // Scroll to bottom
            setTimeout(() => {
                container.scrollTop = container.scrollHeight;
            }, 0);
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (!text || !currentChatId) return;
            
            // Add user's message
            if (!chatMessages[currentChatId]) {
                chatMessages[currentChatId] = [];
            }
            
            chatMessages[currentChatId].push({
                id: 'msg_' + Date.now(),
                text: text,
                sender: 'You',
                timestamp: Date.now()
            });
            
            input.value = '';
            renderChatMessages();
            
            // Simulate receiving a message after a short delay
            setTimeout(() => {
                simulateReceivedMessage();
            }, 500 + Math.random() * 1500);
        }

        function handleMessageKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function simulateReceivedMessage() {
            if (!currentChatId) return;
            
            // Get random response from members - check if it's a group chat
            const groupChat = Object.values(groupChats).find(chat => chat.id === currentChatId);
            if (!groupChat || groupChat.members.length === 0) return;
            
            const randomMember = groupChat.members[Math.floor(Math.random() * groupChat.members.length)];
            const responses = [
                'üëç Thanks for sharing!',
                'That sounds great! üéâ',
                'I agree! Looking forward to it.',
                'Count me in! üí™',
                'Sounds like fun! See you there.',
                'Let me know if you need help.',
                'This is going to be amazing! ‚ú®',
                'Can\'t wait! üôå',
                'Awesome! üòä',
                'Let\'s make it happen! üöÄ'
            ];
            
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            
            if (randomMember.name !== 'You') {
                chatMessages[currentChatId].push({
                    id: 'msg_' + Date.now(),
                    text: randomResponse,
                    sender: randomMember.name,
                    timestamp: Date.now()
                });
                
                renderChatMessages();
            }
        }

        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }

        function toggleConnections() {
            const toggle = document.getElementById('connectionsToggle');
            toggle.classList.toggle('active');
        }

        let selectedCategoriesArray = [];
        let topLevelSelectedCategories = [];

        function toggleCategoryFilter(category) {
            if (topLevelSelectedCategories.includes(category)) {
                topLevelSelectedCategories = topLevelSelectedCategories.filter(c => c !== category);
            } else {
                topLevelSelectedCategories.push(category);
            }
            
            updateFilterButtonStates();
            filterEventsByTopLevel();
        }

        function updateFilterButtonStates() {
            document.getElementById('filterAllBtn').classList.remove('active');
            document.getElementById('filterSocialBtn').classList.toggle('active', topLevelSelectedCategories.includes('social'));
            document.getElementById('filterFitnessBtn').classList.toggle('active', topLevelSelectedCategories.includes('fitness'));
            document.getElementById('filterCreativeBtn').classList.toggle('active', topLevelSelectedCategories.includes('creative'));
            document.getElementById('filterProfessionalBtn').classList.toggle('active', topLevelSelectedCategories.includes('professional'));
        }

        function filterEventsByTopLevel() {
            const eventsList = document.getElementById('eventsList');
            let filteredEvents = sampleEvents;

            if (topLevelSelectedCategories.length > 0) {
                filteredEvents = filteredEvents.filter(e => topLevelSelectedCategories.includes(e.category));
            }

            eventsList.innerHTML = filteredEvents.map(event => `
                <div class="event-card" onclick="showEventDetails(${event.id})">
                    <div class="event-image">
                        ${getCategoryIcon(event.category)}
                        ${getSaveButtonHTML(event.id, event.saved)}
                    </div>
                    <div class="event-info">
                        <div class="event-title">${event.title}</div>
                        <div class="event-meta">üìÖ ${formatDate(event.date)} at ${event.time}</div>
                        <div class="event-meta">üìç ${event.location}</div>
                        <div class="event-meta">üë§ ${event.host}</div>
                        <div class="event-attendees">
                            <div class="attendee-avatars" onclick="showAttendeesList(event, ${event.id}); event.stopPropagation();">
                                ${event.attendees.slice(0, 3).map(attendee => `
                                    <div class="avatar">${attendee.initial}</div>
                                `).join('')}
                                ${event.attendees.length > 3 ? `<div class="avatar">+${event.attendees.length - 3}</div>` : ''}
                            </div>
                            <span class="event-meta">üí¨ ${event.currentAttendees} going</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function addCategoryFilter() {
            const categorySelect = document.getElementById('filterCategory');
            const selectedValue = categorySelect.value;
            
            if (selectedValue && !selectedCategoriesArray.includes(selectedValue)) {
                selectedCategoriesArray.push(selectedValue);
                updateSelectedCategoriesDisplay();
                categorySelect.value = '';
            }
        }

        function removeCategoryFilter(category) {
            selectedCategoriesArray = selectedCategoriesArray.filter(c => c !== category);
            updateSelectedCategoriesDisplay();
        }

        function updateSelectedCategoriesDisplay() {
            const container = document.getElementById('selectedCategoriesContainer');
            const categoryLabels = {
                social: 'üéâ Social',
                fitness: 'üí™ Fitness',
                creative: 'üé® Creative',
                professional: 'üíº Professional'
            };

            container.innerHTML = selectedCategoriesArray.map(category => `
                <div class="category-tag">
                    ${categoryLabels[category]}
                    <button class="remove-btn" onclick="removeCategoryFilter('${category}')">&times;</button>
                </div>
            `).join('');
        }

        function applyAdvancedFilters() {
            const date = document.getElementById('filterDate').value;
            const time = document.getElementById('filterTime').value;
            const maxCost = document.getElementById('filterCost').value;
            const host = document.getElementById('filterHost').value.toLowerCase();
            const location = document.getElementById('filterLocation').value.toLowerCase();

            let filteredEvents = sampleEvents;

            if (selectedCategoriesArray.length > 0) {
                filteredEvents = filteredEvents.filter(e => selectedCategoriesArray.includes(e.category));
            }
            if (date) {
                filteredEvents = filteredEvents.filter(e => e.date === date);
            }
            if (time) {
                filteredEvents = filteredEvents.filter(e => e.time === time);
            }
            if (maxCost) {
                filteredEvents = filteredEvents.filter(e => e.cost <= parseFloat(maxCost));
            }
            if (host) {
                filteredEvents = filteredEvents.filter(e => e.host.toLowerCase().includes(host));
            }
            if (location) {
                filteredEvents = filteredEvents.filter(e => e.location.toLowerCase().includes(location));
            }

            // Display filtered events
            const eventsList = document.getElementById('eventsList');
            eventsList.innerHTML = filteredEvents.map(event => `
                <div class="event-card" onclick="showEventDetails(${event.id})">
                    <div class="event-image">
                        ${getCategoryIcon(event.category)}
                        ${getSaveButtonHTML(event.id, event.saved)}
                    </div>
                    <div class="event-info">
                        <div class="event-title">${event.title}</div>
                        <div class="event-meta">üìÖ ${formatDate(event.date)} at ${event.time}</div>
                        <div class="event-meta">üìç ${event.location}</div>
                        <div class="event-meta">üë§ ${event.host}</div>
                        <div class="event-attendees">
                            <div class="attendee-avatars" onclick="showAttendeesList(event, ${event.id}); event.stopPropagation();">
                                ${event.attendees.slice(0, 3).map(attendee => `
                                    <div class="avatar">${attendee.initial}</div>
                                `).join('')}
                                ${event.attendees.length > 3 ? `<div class="avatar">+${event.attendees.length - 3}</div>` : ''}
                            </div>
                            <span class="event-meta">üí¨ ${event.currentAttendees} going</span>
                        </div>
                    </div>
                </div>
            `).join('');

            closeModal('advancedFiltersModal');
        }

        function resetFilters() {
            document.getElementById('advancedFiltersForm').reset();
            selectedCategoriesArray = [];
            updateSelectedCategoriesDisplay();
            renderEvents();
            closeModal('advancedFiltersModal');
        }

        initTheme();
        renderEvents();
    </script>
</body>

</html>